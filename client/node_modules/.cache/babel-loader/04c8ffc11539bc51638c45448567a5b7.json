{"ast":null,"code":"var _jsxFileName = \"/home/srdjan/Desktop/LS-projects/shopping_cart_sol_hooks_days/client/src/components/Shop.js\";\nimport React, { useState, useEffect } from \"react\";\nimport ShoppingCart from \"./ShoppingCart\";\nimport ProductListing from \"./ProductListing\";\nimport AddProductForm from \"./AddProductForm\";\nimport axios from \"axios\";\n\nconst Shop = () => {\n  const [products, setProducts] = useState([]);\n  const [cart, setCart] = useState([]);\n  useEffect(() => {\n    axios.get(\"/api/products\").then(response => response.data).then(products => {\n      setProducts(products);\n    }).catch(err => {\n      console.log(err);\n    });\n  }, []);\n\n  const indexOfProductInCart = id => {\n    return cart.findIndex(product => product.id === id);\n  };\n\n  const incrementCartItemQuantity = productId => {\n    let updatedCart = cart.map(item => {\n      if (item._id === productId) {\n        return Object.assign({}, item, {\n          quantity: item.quantity + 1\n        });\n      } else {\n        return item;\n      }\n    });\n    setCart(updatedCart);\n  };\n\n  const decrementProductQuantity = productId => {\n    let productToUpdate = products.find(product => product._id === productId);\n    return Object.assign({}, productToUpdate, {\n      quantity: productToUpdate.quantity - 1\n    });\n  };\n\n  const handleAddToCart = productId => {\n    let product = products.find(product => product.id === productId);\n\n    if (product.quantity === 0) {\n      return;\n    }\n\n    let idxInCart = indexOfProductInCart(productId);\n\n    if (idxInCart === -1) {\n      setCart(cart.concat(Object.assign({}, product, {\n        quantity: 1\n      })));\n    } else {\n      incrementCartItemQuantity(productId);\n    }\n\n    let updatedProduct = decrementProductQuantity(productId);\n    let quantity = {\n      quantity: updatedProduct.quantity\n    };\n    handleUpdateProduct(quantity, productId);\n  };\n\n  updateCartItem = updatedProduct => {\n    const cartItemIdx = cart.findIndex(item => item._id === updatedProduct._id);\n    if (cartItemIdx === -1) return;\n    setCart(cart.map(item => {\n      if (item._id === updatedProduct._id) {\n        return Object.assign({}, item, {\n          title: updatedProduct.title,\n          price: updatedProduct.price\n        });\n      } else {\n        return item;\n      }\n    }));\n  };\n\n  const handleCheckout = () => {\n    setCart([]);\n  };\n\n  const handleDeleteProduct = productId => {\n    axios.delete(`/api/products/${productId}`).then(response => response.data).then(() => {\n      setProducts(products.filter(p => p.id !== productId));\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  const handleAddProduct = product => {\n    axios.post(\"/api/products\", { ...product\n    }).then(response => response.data).then(newProduct => {\n      setProducts(products.concat(newProduct));\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  const handleUpdateProduct = (product, id) => {\n    axios.put(`/api/products/${id}`, { ...product\n    }).then(response => response.data).then(newProduct => {\n      const newProducts = products.map(p => {\n        if (p._id === id) {\n          return Object.assign({}, newProduct);\n        } else {\n          return p;\n        }\n      });\n      setProducts(newProducts);\n      updateCartItem(newProduct);\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    id: \"app\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(ShoppingCart, {\n    cart: cart,\n    onCheckout: handleCheckout,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"main\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(ProductListing, {\n    products: products,\n    onAddToCart: handleAddToCart,\n    onDeleteProduct: handleDeleteProduct,\n    onUpdateProduct: handleUpdateProduct,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(AddProductForm, {\n    onAddProduct: handleAddProduct,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 9\n    }\n  })));\n};\n\nexport default Shop;","map":{"version":3,"sources":["/home/srdjan/Desktop/LS-projects/shopping_cart_sol_hooks_days/client/src/components/Shop.js"],"names":["React","useState","useEffect","ShoppingCart","ProductListing","AddProductForm","axios","Shop","products","setProducts","cart","setCart","get","then","response","data","catch","err","console","log","indexOfProductInCart","id","findIndex","product","incrementCartItemQuantity","productId","updatedCart","map","item","_id","Object","assign","quantity","decrementProductQuantity","productToUpdate","find","handleAddToCart","idxInCart","concat","updatedProduct","handleUpdateProduct","updateCartItem","cartItemIdx","title","price","handleCheckout","handleDeleteProduct","delete","filter","p","handleAddProduct","post","newProduct","put","newProducts"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport ShoppingCart from \"./ShoppingCart\";\nimport ProductListing from \"./ProductListing\";\nimport AddProductForm from \"./AddProductForm\";\nimport axios from \"axios\";\n\nconst Shop = () => {\n  const [products, setProducts] = useState([]);\n  const [cart, setCart] = useState([]);\n\n  useEffect(() => {\n    axios\n      .get(\"/api/products\")\n      .then((response) => response.data)\n      .then((products) => {\n        setProducts(products);\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  }, []);\n\n  const indexOfProductInCart = (id) => {\n    return cart.findIndex((product) => product.id === id);\n  };\n\n  const incrementCartItemQuantity = (productId) => {\n    let updatedCart = cart.map((item) => {\n      if (item._id === productId) {\n        return Object.assign({}, item, { quantity: item.quantity + 1 });\n      } else {\n        return item;\n      }\n    });\n    setCart(updatedCart);\n  };\n\n  const decrementProductQuantity = (productId) => {\n    let productToUpdate = products.find((product) => product._id === productId);\n    return Object.assign({}, productToUpdate, {\n      quantity: productToUpdate.quantity - 1,\n    });\n  };\n\n  const handleAddToCart = (productId) => {\n    let product = products.find((product) => product.id === productId);\n    if (product.quantity === 0) {\n      return;\n    }\n    let idxInCart = indexOfProductInCart(productId);\n    if (idxInCart === -1) {\n      setCart(cart.concat(Object.assign({}, product, { quantity: 1 })));\n    } else {\n      incrementCartItemQuantity(productId);\n    }\n    let updatedProduct = decrementProductQuantity(productId);\n    let quantity = { quantity: updatedProduct.quantity };\n\n    handleUpdateProduct(quantity, productId);\n  };\n\n  updateCartItem = (updatedProduct) => {\n    const cartItemIdx = cart.findIndex(\n      (item) => item._id === updatedProduct._id\n    );\n    if (cartItemIdx === -1) return;\n    setCart(\n      cart.map((item) => {\n        if (item._id === updatedProduct._id) {\n          return Object.assign({}, item, {\n            title: updatedProduct.title,\n            price: updatedProduct.price,\n          });\n        } else {\n          return item;\n        }\n      })\n    );\n  };\n\n  const handleCheckout = () => {\n    setCart([]);\n  };\n\n  const handleDeleteProduct = (productId) => {\n    axios\n      .delete(`/api/products/${productId}`)\n      .then((response) => response.data)\n      .then(() => {\n        setProducts(products.filter((p) => p.id !== productId));\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n\n  const handleAddProduct = (product) => {\n    axios\n      .post(\"/api/products\", { ...product })\n      .then((response) => response.data)\n      .then((newProduct) => {\n        setProducts(products.concat(newProduct));\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n\n  const handleUpdateProduct = (product, id) => {\n    axios\n      .put(`/api/products/${id}`, { ...product })\n      .then((response) => response.data)\n      .then((newProduct) => {\n        const newProducts = products.map((p) => {\n          if (p._id === id) {\n            return Object.assign({}, newProduct);\n          } else {\n            return p;\n          }\n        });\n        setProducts(newProducts);\n        updateCartItem(newProduct);\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n\n  return (\n    <div id=\"app\">\n      <ShoppingCart cart={cart} onCheckout={handleCheckout} />\n\n      <main>\n        <ProductListing\n          products={products}\n          onAddToCart={handleAddToCart}\n          onDeleteProduct={handleDeleteProduct}\n          onUpdateProduct={handleUpdateProduct}\n        />\n        <AddProductForm onAddProduct={handleAddProduct} />\n      </main>\n    </div>\n  );\n};\n\nexport default Shop;\n"]},"metadata":{},"sourceType":"module"}