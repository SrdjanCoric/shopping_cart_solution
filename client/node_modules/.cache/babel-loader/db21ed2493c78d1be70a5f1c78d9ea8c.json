{"ast":null,"code":"var _jsxFileName = \"/home/srdjan/Desktop/LS-projects/shopping_cart_sol_hooks_days/client/src/components/Shop.js\";\nimport React, { useState, useEffect } from \"react\";\nimport ShoppingCart from \"./ShoppingCart\";\nimport ProductListing from \"./ProductListing\";\nimport AddProductForm from \"./AddProductForm\";\nimport axios from \"axios\";\n\nconst Shop = () => {\n  const [products, setProducts] = useState([]);\n  const [cart, setCart] = useState([]);\n  useEffect(() => {\n    axios.get(\"/api/products\").then(response => response.data).then(products => {\n      setProducts(products);\n    }).catch(err => {\n      console.log(err);\n    });\n  }, []);\n\n  const indexOfProductInCart = id => {\n    return cart.findIndex(product => product._id === id);\n  };\n\n  const incrementCartItemQuantity = productId => {\n    let updatedCart = cart.map(item => {\n      if (item._id === productId) {\n        return Object.assign({}, item, {\n          quantity: item.quantity + 1\n        });\n      } else {\n        return item;\n      }\n    });\n    setCart(updatedCart);\n  };\n\n  const decrementProductQuantity = productId => {\n    let productToUpdate = products.find(product => product._id === productId);\n    return Object.assign({}, productToUpdate, {\n      quantity: productToUpdate.quantity - 1\n    });\n  };\n\n  const handleCart = (idxInCart, product, productId) => {\n    if (idxInCart === -1) {\n      setCart(cart.concat(Object.assign({}, product, {\n        quantity: 1\n      })));\n    } else {\n      incrementCartItemQuantity(productId);\n    }\n  };\n\n  const handleAddToCart = productId => {\n    let product = products.find(product => product._id === productId);\n\n    if (product.quantity === 0) {\n      return;\n    }\n\n    let idxInCart = indexOfProductInCart(productId);\n    let updatedProduct = decrementProductQuantity(productId);\n    let quantity = {\n      quantity: updatedProduct.quantity\n    };\n    handleUpdateProduct({\n      quantity: product.quantity - 1\n    }, productId, handleCart);\n  };\n\n  const updateCartItem = updatedProduct => {\n    const cartItemIdx = cart.findIndex(item => item._id === updatedProduct._id);\n    if (cartItemIdx === -1) return;\n    setCart(cart.map(item => {\n      if (item._id === updatedProduct._id) {\n        return Object.assign({}, item, {\n          title: updatedProduct.title,\n          price: updatedProduct.price\n        });\n      } else {\n        return item;\n      }\n    }));\n  };\n\n  const handleCheckout = () => {\n    setCart([]);\n  };\n\n  const handleDeleteProduct = productId => {\n    axios.delete(`/api/products/${productId}`).then(response => response.data).then(() => {\n      setProducts(products.filter(p => p._id !== productId));\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  const handleAddProduct = product => {\n    axios.post(\"/api/products\", { ...product\n    }).then(response => response.data).then(newProduct => {\n      setProducts(products.concat(newProduct));\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  const handleUpdateProduct = (product, id) => {\n    axios.put(`/api/products/${id}`, { ...product\n    }).then(response => response.data).then(newProduct => {\n      const newProducts = products.map(p => {\n        if (p._id === id) {\n          return Object.assign({}, newProduct);\n        } else {\n          return p;\n        }\n      });\n      setProducts(newProducts);\n      updateCartItem(product);\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    id: \"app\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(ShoppingCart, {\n    cart: cart,\n    onCheckout: handleCheckout,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"main\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(ProductListing, {\n    products: products,\n    onAddToCart: handleAddToCart,\n    onDeleteProduct: handleDeleteProduct,\n    onUpdateProduct: handleUpdateProduct,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(AddProductForm, {\n    onAddProduct: handleAddProduct,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 9\n    }\n  })));\n};\n\nexport default Shop;","map":{"version":3,"sources":["/home/srdjan/Desktop/LS-projects/shopping_cart_sol_hooks_days/client/src/components/Shop.js"],"names":["React","useState","useEffect","ShoppingCart","ProductListing","AddProductForm","axios","Shop","products","setProducts","cart","setCart","get","then","response","data","catch","err","console","log","indexOfProductInCart","id","findIndex","product","_id","incrementCartItemQuantity","productId","updatedCart","map","item","Object","assign","quantity","decrementProductQuantity","productToUpdate","find","handleCart","idxInCart","concat","handleAddToCart","updatedProduct","handleUpdateProduct","updateCartItem","cartItemIdx","title","price","handleCheckout","handleDeleteProduct","delete","filter","p","handleAddProduct","post","newProduct","put","newProducts"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport ShoppingCart from \"./ShoppingCart\";\nimport ProductListing from \"./ProductListing\";\nimport AddProductForm from \"./AddProductForm\";\nimport axios from \"axios\";\n\nconst Shop = () => {\n  const [products, setProducts] = useState([]);\n  const [cart, setCart] = useState([]);\n\n  useEffect(() => {\n    axios\n      .get(\"/api/products\")\n      .then((response) => response.data)\n      .then((products) => {\n        setProducts(products);\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  }, []);\n\n  const indexOfProductInCart = (id) => {\n    return cart.findIndex((product) => product._id === id);\n  };\n\n  const incrementCartItemQuantity = (productId) => {\n    let updatedCart = cart.map((item) => {\n      if (item._id === productId) {\n        return Object.assign({}, item, { quantity: item.quantity + 1 });\n      } else {\n        return item;\n      }\n    });\n    setCart(updatedCart);\n  };\n\n  const decrementProductQuantity = (productId) => {\n    let productToUpdate = products.find((product) => product._id === productId);\n    return Object.assign({}, productToUpdate, {\n      quantity: productToUpdate.quantity - 1,\n    });\n  };\n\n  const handleCart = (idxInCart, product, productId) => {\n    if (idxInCart === -1) {\n      setCart(cart.concat(Object.assign({}, product, { quantity: 1 })));\n    } else {\n      incrementCartItemQuantity(productId);\n    }\n  };\n\n  const handleAddToCart = (productId) => {\n    let product = products.find((product) => product._id === productId);\n    if (product.quantity === 0) {\n      return;\n    }\n    let idxInCart = indexOfProductInCart(productId);\n\n    let updatedProduct = decrementProductQuantity(productId);\n    let quantity = { quantity: updatedProduct.quantity };\n\n    handleUpdateProduct(\n      { quantity: product.quantity - 1 },\n      productId,\n      handleCart\n    );\n  };\n\n  const updateCartItem = (updatedProduct) => {\n    const cartItemIdx = cart.findIndex(\n      (item) => item._id === updatedProduct._id\n    );\n    if (cartItemIdx === -1) return;\n    setCart(\n      cart.map((item) => {\n        if (item._id === updatedProduct._id) {\n          return Object.assign({}, item, {\n            title: updatedProduct.title,\n            price: updatedProduct.price,\n          });\n        } else {\n          return item;\n        }\n      })\n    );\n  };\n\n  const handleCheckout = () => {\n    setCart([]);\n  };\n\n  const handleDeleteProduct = (productId) => {\n    axios\n      .delete(`/api/products/${productId}`)\n      .then((response) => response.data)\n      .then(() => {\n        setProducts(products.filter((p) => p._id !== productId));\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n\n  const handleAddProduct = (product) => {\n    axios\n      .post(\"/api/products\", { ...product })\n      .then((response) => response.data)\n      .then((newProduct) => {\n        setProducts(products.concat(newProduct));\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n\n  const handleUpdateProduct = (product, id) => {\n    axios\n      .put(`/api/products/${id}`, { ...product })\n      .then((response) => response.data)\n      .then((newProduct) => {\n        const newProducts = products.map((p) => {\n          if (p._id === id) {\n            return Object.assign({}, newProduct);\n          } else {\n            return p;\n          }\n        });\n        setProducts(newProducts);\n        updateCartItem(product);\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n\n  return (\n    <div id=\"app\">\n      <ShoppingCart cart={cart} onCheckout={handleCheckout} />\n\n      <main>\n        <ProductListing\n          products={products}\n          onAddToCart={handleAddToCart}\n          onDeleteProduct={handleDeleteProduct}\n          onUpdateProduct={handleUpdateProduct}\n        />\n        <AddProductForm onAddProduct={handleAddProduct} />\n      </main>\n    </div>\n  );\n};\n\nexport default Shop;\n"]},"metadata":{},"sourceType":"module"}